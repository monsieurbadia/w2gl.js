<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>w2gl</title>
    <style>
      body {
        margin: 0;
        background: #ffffff;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <script src="https://threejs.org/build/three.min.js"></script>
    <script src="./index.js"></script>
    <script>
      
      // console.log( W2GL ); // { default: { init: f}, __esModule: true }

      document.addEventListener( 'DOMContentLoaded', _ => {

        // W2GL test implementation

        W2GL.W2GL.init( {

          scene: {
            scene1: {}
          },
          camera: {
            camera1: {
              size: [ window.innerWidth, window.innerHeight ],
              type: 'perspective'
            }
          },
          mesh: {
            plane: {
              geometry: {
                buffer: true,
                options: [ 2, 2 ],
                specific: 'plane'
              },
              material: {
                options: {
                  transparent: true
                },
                specific: 'normal'
              },
              shader: {
                vertex: `

                  #ifdef GL_ES
                  precision mediump float;
                  #endif

                  uniform vec2 resolution;

                  varying vec2 vUv;

                  void main () {

                    vec2 _position = vec2( position.xy );

                    vUv = uv;
                    vUv = position.xy;
                    vUv.x *= resolution.x / resolution.y;

                    gl_Position = vec4( position.xy, 0.0, 1.0 );
                  }
 
                `,
                fragment: `
  
                  #ifdef GL_ES
                  precision mediump float;
                  #endif

                  uniform vec2 resolution;
                  uniform float time;

                  varying vec2 vUv;

                  void main () {

                    gl_FragColor = vec4( vUv, 0.0, 1.0 );

                  }

                `
              }
            }
          },
          renderer: {
            renderer1: {
              options: {
                antialias: true,
                pixelRatio: window.devicePixelRatio,
                size: [ window.innerWidth, window.innerHeight ],
              }
            }
          }

        }, ( starter ) => {

          console.log( starter );

          /* create scene */

          // 1. init scene
          starter.scene.scene1.init( [ starter.mesh.plane ] );

          // 2. init camera
          starter.camera.camera1.init(  );

          // 3. init renderer
          starter.renderer.renderer1.autoClear = false;

          starter.renderer.renderer1.init( starter.scene.scene1, starter.camera.camera1 );

          // 4. init events (optional)
          starter.event.onresize( starter.screen.resize );
          // starter.event.onmousemove( starter.mouse.mousemove );

          /* then use listeners to update things */

          // onrender: update mesh
          starter.mesh.plane.onrender( timer => {

            starter.mesh.plane.material.uniforms.time.value = timer.time;

          } );

          // onresize: refresh renderer size
          starter.renderer.renderer1.onresize( event => {

            starter.renderer.renderer1.setSize( starter.screen.width, starter.screen.height );

          } );

          // onmousemove: set mouse coordinates values
          starter.mesh.plane.onmousemove( event => {

            starter.mesh.plane.material.uniforms.mouse.value.x = starter.mouse.x;
            starter.mesh.plane.material.uniforms.mouse.value.y = starter.mouse.y;

          } );

          // onresize: update resolution coordinates values
          starter.mesh.plane.onresize( event => {

            starter.mesh.plane.material.uniforms.resolution.value.x = starter.screen.width;
            starter.mesh.plane.material.uniforms.resolution.value.y = starter.screen.height;

          } );

        } );

      }, false );

    </script>
  </body>
</html>