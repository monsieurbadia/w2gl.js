<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>w2gl</title>
    <style>
      body {
        margin: 0;
        background: #ffffff;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <script src="./index.js"></script>
    <script>
      
      // console.log( W2GL ); // { default: { init: f}, __esModule: true }

      document.addEventListener( 'DOMContentLoaded', _ => {

        // W2GL test implementation

        W2GL.W2GL.init( {

          scene: {
            scene1: {}
          },
          camera: {
            camera1: {
              size: [ window.innerWidth, window.innerHeight ],
              type: 'perspective'
            }
          },
          mesh: {
            plane: {
              geometry: {
                buffer: true,
                options: [ 2, 2 ],
                specific: 'plane'
              },
              material: {
                options: {
                  transparent: true
                },
                specific: 'normal'
              },
              shader: {
                uniforms: {
                  mouse: { type: 'v2', value: [] },
                  resolution: { type: 'v2', value: [] },
                  time: { type: 'f', value: 1.0 }
                },
                vertex: `

                  #ifdef GL_ES
                  precision mediump float;
                  #endif

                  void main () {

                    gl_Position = vec4( position, 1.0 );

                  }

                `,
                fragment: `

                  #ifdef GL_ES
                  precision mediump float;
                  #endif

                  uniform vec2 resolution;
                  uniform vec2 mouse;
                  uniform float time;

                  void main () {

                    vec2 st = gl_FragCoord.xy/resolution;
                    gl_FragColor = vec4(st.x,st.y,0.0,1.0);
                    
                  }

                `
              }
            }
          },
          renderer: {
            renderer1: {
              options: {
                antialias: true,
                pixelRatio: window.devicePixelRatio,
                size: [ window.innerWidth, window.innerHeight ],
              }
            }
          }

        }, ( starter ) => {

          console.log( starter );

          // 1. init scene
          starter.scene.scene1.init( [ starter.mesh.plane ] );

          // 2. init camera
          starter.camera.camera1.init( [ 0, 0, 1 ] );

          // 3. init renderer
          starter.renderer.renderer1.init( starter.scene.scene1, starter.camera.camera1 );

          // 4. update mesh
          starter.mesh.plane.onrender( timer => {

            starter.mesh.plane.material.uniforms.time.value = timer.time;

          } );

          // init events
          starter.event.onresize( starter.screen.resize );
          starter.event.onmousemove( starter.mouse.mousemove );

          // resize renderer
          starter.renderer.renderer1.onresize( _ => {

            starter.renderer.renderer1.setSize( starter.screen.width, starter.screen.height );

          } );

          // mousemove listener mesh
          starter.mesh.plane.onmousemove( _ => {

            starter.mesh.plane.material.uniforms.mouse.value.x = starter.mouse.x;
            starter.mesh.plane.material.uniforms.mouse.value.y = starter.mouse.y;

          } );

          // resize listener mesh
          starter.mesh.plane.onresize( _ => {

            starter.mesh.plane.material.uniforms.resolution.value.x = starter.screen.width;
            starter.mesh.plane.material.uniforms.resolution.value.y = starter.screen.height;

          } );

        } );

      }, false );

    </script>
  </body>
</html>