(function () {function b(a){return a&&a.__esModule?{d:a.default}:{d:a}}var e={};function u(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function z(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?u(Object(t),!0).forEach(function(r){var $IxO8$$interop$default=b(f);$IxO8$$interop$default.d(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var f={};function ia(e,r,$){return r in e?Object.defineProperty(e,r,{value:$,enumerable:!0,configurable:!0,writable:!0}):e[r]=$,e}f=ia;var c={};function ea(a,c){if(!(a instanceof c))throw new TypeError("Cannot call a class as a function")}c=ea;var ba=function e(){var $fcMS$$interop$default=b(c);$fcMS$$interop$default.d(this,e),this.run={webgl:function(){var e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),r=null,l=!1;try{null==(r=e.getContext("experimental-webgl"))&&(r=e.getContext("webgl")),l=!0}catch(t){r=null,l=!1,console.warn(t)}return e=null,null!==r&&l}}};var a={};function k(e,r){for(var $=0;$<r.length;$++){var a=r[$];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Z(e,r,$){return r&&k(e.prototype,r),$&&k(e,$),e}a=Z;var W=function(){function e(){var $fcMS$$interop$default=b(c);$fcMS$$interop$default.d(this,e)}var $P8NW$$interop$default=b(a);return $P8NW$$interop$default.d(e,[{key:"onmousemove",value:function(e){e&&d.DEFAULT.mousemoveList.push(e),window.addEventListener("mousemove",this.mousemove,!1)}},{key:"onresize",value:function(e){e&&d.DEFAULT.resizeList.push(e),window.addEventListener("resize",this.resize,!1)}},{key:"mousemove",value:function(e){d.DEFAULT.mousemoveList.forEach(function(r){return r(e)})}},{key:"resize",value:function(e){d.DEFAULT.resizeList.forEach(function(r){return r(e)})}},{key:"clear",value:function(){window.removeEventListener("mousemove",this.mousemove,!1),window.removeEventListener("resize",this.resize,!1)}}]),e}();var r=function(){function e(){var $fcMS$$interop$default=b(c);$fcMS$$interop$default.d(this,e),this.x=0,this.y=0,this.mousemove=this.mousemove.bind(this)}var $P8NW$$interop$default=b(a);return $P8NW$$interop$default.d(e,[{key:"mousemove",value:function(e){var s=e.clientX,t=e.clientY,r=e.pageX,i=e.pageY,$=s||r,a=t||i;this.set($,a)}},{key:"set",value:function(e,s){this.x=e,this.y=s}}]),e}();var S=function(){function e(){var $fcMS$$interop$default=b(c);$fcMS$$interop$default.d(this,e),this.width=window.innerWidth,this.height=window.innerHeight,this.resize=this.resize.bind(this)}var $P8NW$$interop$default=b(a);return $P8NW$$interop$default.d(e,[{key:"resize",value:function(e){this.width=e.target.innerWidth,this.height=e.target.innerHeight}}]),e}();function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,a)}return t}function R(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach(function(r){var $IxO8$$interop$default=b(f);$IxO8$$interop$default.d(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var i={};function O(r,a){(null==a||a>r.length)&&(a=r.length);for(var $=0,e=new Array(a);$<a;$++)e[$]=r[$];return e}i=O;var M={};function L(r){if(Array.isArray(r))return i(r)}M=L;var H={};function D(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}H=D;var B={};function t(r,a){if(r){if("string"==typeof r)return i(r,a);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?i(r,a):void 0}}B=t;var T={};function A(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}T=A;var h={};function C(r){return M(r)||H(r)||B(r)||T()}h=C;var y=function e(r,t){var $fcMS$$interop$default=b(c);if($fcMS$$interop$default.d(this,e),t){var a={},n=void 0!==t.uniforms?Object.assign(d.SHADER.UNIFORMS,t.uniforms):d.SHADER.UNIFORMS;return a.uniforms=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce(function(t,a){var n=e[a];var $IxO8$$interop$default=b(f);return R({},t,$IxO8$$interop$default.d({},a,d.MATH.TYPES.includes(n.type)?function(e){var t,a=e.type,n=e.value,l=d.MATH.PRIMITIVES[a];var $Fhqp$$interop$default=b(h);e.value=new r[l],n.length>0&&(t=e.value).set.apply(t,$Fhqp$$interop$default.d(n));return e}(n):n))},{})}(n),a.vertexShader=t.vertex,a.fragmentShader=t.fragment,function(e){Object.keys(d.SHADER.CORE).forEach(function(r){var t=d.SHADER.CORE[r];switch(t.type){case"vertex":e.vertexShader=e.vertexShader.includes(t.name)?e.vertexShader.replace(t.name,t.template):e.vertexShader;break;case"fragment":e.fragmentShader=e.fragmentShader.includes(t.name)?e.fragmentShader.replace(t.name,t.template):e.fragmentShader;break;default:return;}})}(a),a}};var E=function(){function e(){var $fcMS$$interop$default=b(c);$fcMS$$interop$default.d(this,e),this.speed=.05,this.time=0}var $P8NW$$interop$default=b(a);return $P8NW$$interop$default.d(e,[{key:"render",value:function(){this.time+=this.speed}}]),e}();var F=Object.freeze({BROWSER:new ba,EVENT:new W,MOUSE:new r,SCREEN:new S,SHADER:new y,LIST:["browser","event","mouse","screen"]});var G=Object.freeze({mousemoveList:[],renderList:[],resizeList:[]});var ma=Object.freeze({v2:"Vector2",v3:"Vector3",v4:"Vector4"}),I=Object.freeze(["v2","v3","v4"]),J=Object.freeze({PRIMITIVES:ma,TYPES:I});var K=Object.freeze({CORE:{color:{name:"#include <core_color>",template:"",type:"fragment"},vertex:{name:"#include <core_vertex>",template:"",type:"vertex"},fragment:{name:"#include <core_fragment>",template:"",type:"fragment"}},UNIFORMS:{mouse:{type:"v2",value:[]},resolution:{type:"v2",value:[window.innerWidth,window.innerHeight]},time:{type:"f",value:1}}});var d={CORE:F,DEFAULT:G,MATH:J,SHADER:K};function v(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);r&&(p=p.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,p)}return t}function N(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?v(Object(t),!0).forEach(function(r){var $IxO8$$interop$default=b(f);$IxO8$$interop$default.d(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):v(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var j=function(t){return void 0===t||0===Object.keys(t).length};var P=function(r,e){return e(r)},Q=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return function(r){return[].concat(e).reduce(P,r||{})}};function q(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function p(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?q(Object(t),!0).forEach(function(r){var $IxO8$$interop$default=b(f);$IxO8$$interop$default.d(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):q(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var g=function(e,r){return Object.keys(e).reduce(function(t,o){var $IxO8$$interop$default=b(f);return p({},t,$IxO8$$interop$default.d({},o,r(p({},e[o]))))},{})};var U=function e(r,t){var $fcMS$$interop$default=b(c);$fcMS$$interop$default.d(this,e);var p=new r.Camera;return Object.assign(p,{init:function(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];var $Fhqp$$interop$default=b(h);r.length>0&&(e=p.position).set.apply(e,$Fhqp$$interop$default.d(r))}}),p};var V=function(e){var r=j(e.camera)?{current:{size:[window.innerWidth,window.innerHeight],type:"perspective"}}:e.camera;return N({},e,{camera:g(r,function(r){return new U(e.THREE,r)})})};function m(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function X(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?m(Object(t),!0).forEach(function(r){var $IxO8$$interop$default=b(f);$IxO8$$interop$default.d(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var Y={};function l(t,r){return Y=l=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t},l(t,r)}Y=l;var _={};function $(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}_=$;var aa={};function x(t,r,$){return aa=x=_()?Reflect.construct:function(t,r,$){var e=[null];e.push.apply(e,r);var c=new(Function.bind.apply(t,e));return $&&Y(c,$.prototype),c},x.apply(null,arguments)}aa=x;var ca=function e(r,t){var $fcMS$$interop$default=b(c);$fcMS$$interop$default.d(this,e);var o=Object.keys(t.shader).map(function(e){var $dJhE$$interop$default=b(aa);var $Fhqp$$interop$default=b(h);var o=new y(r,t.shader[e]),$=new r.ShaderMaterial(o),n=$dJhE$$interop$default.d(r.PlaneBufferGeometry,$Fhqp$$interop$default.d(t.geometry.option));return new r.Mesh(n,$)})[0];return Object.assign(o,{onmousemove:function(e){return d.DEFAULT.mousemoveList.push(e)},onresize:function(e){return d.DEFAULT.resizeList.push(e)},onrender:function(e){return d.DEFAULT.renderList.push(e)}})};var da=function(e){var r;return e.shader?r=Object.assign({},{current:{geometry:{buffer:!0,option:[2,2],specific:"plane"},material:{option:{},specific:"normal"},shader:e.shader}}):e.mesh&&e.mesh.shader&&(r=e.mesh),X({},e,{shader:g(r,function(r){return new ca(e.THREE,r)})})};function w(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function fa(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?w(Object(t),!0).forEach(function(r){var $IxO8$$interop$default=b(f);$IxO8$$interop$default.d(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var ga=function e(r,t){var $fcMS$$interop$default=b(c);$fcMS$$interop$default.d(this,e);var n=new r.WebGLRenderer({antialias:!0}),o=new E;function i(e){window.document.body.appendChild(e)}function $(e){var $Fhqp$$interop$default=b(h);n.setClearColor(0),n.setPixelRatio(window.devicePixelRatio),n.setSize.apply(n,$Fhqp$$interop$default.d(e.option.size).concat([!0]))}function a(e){d.DEFAULT.resizeList.push(e)}return $(t),i(n.domElement),n.onresize=a.bind(n),Object.assign(n,{add:i,init:function(e,r){n.current={camera:r,scene:e},n.setTimerAnimationLoop()},create:$,onresize:a,setTimerAnimationLoop:function(e){n.setAnimationLoop(null!==e?function(r){o.render(),d.DEFAULT.renderList.forEach(function(e){return e(o)}),e&&e(o),n.render(n.current.scene,n.current.camera)}:null)}})};var ha=function(e){var r=j(e.renderer)?{current:{option:{antialias:!0,pixelRatio:window.devicePixelRatio,size:[window.innerWidth,window.innerHeight]}}}:e.renderer;return fa({},e,{renderer:g(r,function(r){return new ga(e.THREE,r)})})};function s(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function ja(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?s(Object(t),!0).forEach(function(r){var $IxO8$$interop$default=b(f);$IxO8$$interop$default.d(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var ka=function e(r,t){var $fcMS$$interop$default=b(c);$fcMS$$interop$default.d(this,e);var n=new r.Scene;return Object.assign(n,{addMeshes:function(e){e.forEach(function(e){return n.add(e)})},init:function(e){n.addMeshes(e)}})};var la=function(e){var r=j(e.scene)?{current:{}}:e.scene;return ja({},e,{scene:g(r,function(r){return new ka(e.THREE,r)})})};var n={init:function(e,r){var t=[la,V,ha,da],o=d.CORE.LIST.reduce(function(e,r){var $IxO8$$interop$default=b(f);return z({},e,$IxO8$$interop$default.d({},r,d.CORE[r.toUpperCase()]))},Object.assign({},z({},e))),c=Q.apply(void 0,t)(o);if(c.browser.run.webgl())return c.scene.current.init([c.shader.current]),c.camera.current.init([0,0,-1]),c.renderer.current.init(c.scene.current,c.camera.current),void 0===r?c:r(c)}};e.default=n,e=n;if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e}else if(typeof define==="function"&&define.amd){define(function(){return e})}else{this["w2gl"]=e}})();